# 보행미안 : 교통사고 예방을 위한 스마트폰 사용 보행자 행동 인식 및 알림 시스템

![smombie](https://user-images.githubusercontent.com/41510487/58851628-8092cc80-86ce-11e9-8363-eb456369161b.jpg)   
•	횡단 보도 내의 보행자를 인식하고 보행자의 실시간 영상을 수집한다.     
•	수집된 보행자 영상을 기반으로 보행자의 행동을 인식하여 스마트폰 사용여부를 실시간으로 판단한다.    
•	보행자가 스마트폰을 사용하고 있는 것으로 판단되면 보행자에게 경고 알림을 줌으로써 보행 중 교통사고를 예방한다.   




## 1. 프로젝트 개요
최근 스마트폰 사용 보행자의 교통사고율이 증가함에 따라 보행자 포즈 인식을 통한 경고 시스템의 필요성이 대두되었다. 
> "보행자의 스마트폰 사용으로 인한 교통사고 사상자는 연간 약 1천 300여명으로, 보행자 교통사고의 약 61.7%가 스마트폰 사용 중에 발생한다." -삼성교통안전문화연구원   
   
해외에서는 보행 중 스마트폰 사용에 법적 제재를 가하는 등의 조치를 취하고 있으며 국내에서는 횡단보도에 스마트폰 정지선을 표시하거나 바닥 신호등을 시범운영하는 등 교통ㆍ통신 기술적으로 안전한 보행 환경 조성을 위한 노력이 이어지고 있다. 또한 IoT 와 통신 기술을 활용하여 보행 중 스마트폰 사용을 방지하는 앱이 출시되고, 스마트폰에 ‘보행 중 모드’를 도입하는 방안이 제시되었다.   
   
> 바닥신호등은 보행자 신호등이 녹색과 적생으로 바뀜에 따라 바닥신호등이 같이 바뀌고 신호가 얼마 남지 않으면 깜빡거리는 등 빛으로 신호를 주는 방식이다. 보행 중 스마트폰 화면 잠김 기능을 하는 '사이버안심존' 어플리케이션도 등장했다. 하지만 바닥신호등은 횡단보도 중간지점에서 보행중인 보행자에게 경고를 주기 어렵다는 한계가 있고, 어플리케이션의 경우 스마트폰에 설치를 하지 않으면 아무 소용이 없다.   
   
이렇게 전세계적으로 보행자의 스마트폰 사용 규제가 강화되고 있는 추세에 발맞추어 언제 어디에서 나타날지 모르는 스마트폰 사용 보행자를 감지하기 위해 보행자의 스마트폰 사용 포즈 인식에 최적화된 인공 신경망 모델을 구축하고자 한다. 스마트폰 사용 보행자가 감지되었을 때 이들에게 스마트폰 사용을 경고하는 알림을 준다면 보다 효율적이고 안전한 보행환경을 조성할 수 있을 것이며, 더 나아가 스마트폰 사용 보행자 포즈 인식 모델은 효율적인 보행자 포즈 인식 및 분석을 위한 소프트웨어를 제공할 수 있을 것이다.   
   
   
   
## 2. 개발 모듈   
### (1) Haar XML   
이미지의 영역과 영역의 밝기차를 바탕으로 학습하여  feature를 조합하는 방법으로  smombie  detect를 수행한다.
- 개발 과정   
> 1. 스마트폰 사용 보행자 사진 데이터 수집   
> 2. Haar training 툴을 이용해 사진을 자세별로 분류   
>> 총 7개 : 오른쪽옆, 오른쪽으로 45도, 정면 양손, 정면 왼손, 정면 오른손, 왼쪽으로 45도, 왼쪽옆    
> 3. 7가지 분류의 자세를 각각 검출하는 xml 생성    
> 4. 얼굴+팔의 object를 이용해 smombie검출 xml과 오직 팔의 모양만을 이용해 검출하는 xml 모두 생성, 비교
> 5. fullbody.xml을 이용하여 보행자 먼저 검출 후 smombie 검출  
> 6. 보행자 피부 색깔을 이용해 해당 범위 내에 피부색이 일치하면 감지   
> 7. xml을 영상에서 수행
   
- 개발 결과    
> 정확도를 높이기 위해 fullbody.xml, 피부색 검출 등의 코드를 이용했지만 정확도가 많이 떨어짐.  
> 사람 이외의 것들도 인식을 하여 핸드폰을 들고 있는 사람을 검출하는 것 자체가 불가하다고 판단.   
> tensorflow를 사용하여 학습을 하기로 경로를 변경.     

### (2) LeNet   
CNN 모델의 한 종류로, LeNet-4기반의 모델을 변형하며 최적화시켜 smombie와 not smombie를 이진 분류한다.   

- 보행자 특이 포즈 인식을 위한 모델링   
> 보행자의 특이 포즈 중, 스마트폰을 사용하는 포즈를 인식하는 모델의 최적화를 위해 스마트폰을 사용하는 보행자와 사용하지 않는 보행자를 이원적으로 구분하는 LeNet-4 기반 모델을 설계한다. 
 이후 LeNet-4기반 모델의 다양한 파라미터를 표 1과 같이 수정하여 각 모델의 성능을 분석한다.   
> ![lenet_modeling](https://user-images.githubusercontent.com/41510487/58853172-475d5b00-86d4-11e9-961e-579d26c05bff.JPG)   
- 모델 테스트 및 분석   
> 학습에 사용되지 않은 스마트폰 사용 보행자 사진 150장과 미사용 보행자 사진 150장을 테스트 데이터로 사용하여 네 가지 지표(Precision, Recall, Accuracy, F1 score)로 모델의 정확도를 평가    
   
### (3) YOLO   
딥러닝 기반으로 학습된 object를 실시간으로 잡아내는 오픈소스 시스템으로, smombie class를 생성하고 잡아내도록 한다.   
### (4) ImageAI   
ResNet 등의 CNN을 이용한 오픈소스 라이브러리로, smombie class를 생성하고 학습시켜 smombie class로  분류한다.    
### (5) OpenPose   
사람의 얼굴, 어깨, 팔꿈치, 무릎, 발 등의 위치를 실시간으로 좌표값으로 나타내어, smombie행동의 수치값을 저장하여 학습시킨다.   
   
   
   
## 3. 프로젝트 주요 진행사항
- 스마트폰 사용 보행자 이미지 데이터 수집   
- HaarXML 모델 테스트 완료   
- ImageAI 모델 학습 및 테스트 완료   
- 산학멘토 선정 및 오프라인 멘토링 수행   
- LeNet 모델링 및 테스트 완료   
- YOLO 모델링 및 테스트 완료   
- 2019 한국멀티미디어학회 춘계학술발표대회 참가   
>『스마트폰 사용 보행자의 행동 인식을 위한 인공 신경망 모델링, 2019년도 한국멀티미디어학회 춘계학술발표대회 논문집 제22권 1호
   
      
    
